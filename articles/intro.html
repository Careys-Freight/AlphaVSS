<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>About this document </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="About this document ">
    <meta name="generator" content="docfx 2.47.0.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="about-this-document">About this document</h1>

<p>This document is mainly provided as an API reference and usage guidance to the AlphaVSS API. It does not cover the operation of the <a class="xref" href="https://docs.microsoft.com/en-us/windows/win32/vss/volume-shadow-copy-service-portal">Volume Shadow Copy Service</a>, or how it should be used by developers.</p>
<p>To gain a full understanding of the Volume Shadow Copy Service you should refer to the <a class="xref" href="https://docs.microsoft.com/en-us/windows/win32/vss/volume-shadow-copy-service-portal">official Microsoft documentation on VSS</a>.</p>
<h1 id="introduction">Introduction</h1>
<p>The <a class="xref" href="https://docs.microsoft.com/en-us/windows/win32/vss/volume-shadow-copy-service-portal">Volume Shadow Copy Service (VSS)</a> is a set of COM interfaces included in Microsoft Windows, that implements a framework to allow volume backups to be performed while applications on a system continue to write to the volumes.</p>
<p>AlphaVSS is a .NET class library written in C++/CLI aiming to provide a managed interface to this API. The goal is to provide an interface that is simple to use from a C# or VB.NET application, yet providing the full functionality of VSS.</p>
<p>AlphaVSS duplicates the original VSS API quite closely, but some things have been changed to conform more to the .NET way of doing things. The following is a brief summary of some of the differences:</p>
<ul>
<li><p>Most of the interfaces from the VSS API are exposed as classes in AlphaVSS. So <code>IVssSnapshotProp</code> becomes <a class="xref" href="../api/Alphaleonis.Win32.Vss.VssSnapshotProperties.html">VssSnapshotProperties</a> and so on.</p>
</li>
<li><p>Identifiers are CamelCased and rewritten to avoid abbreviations and unneccessary prefixes. So eg. <code>VSSSNAPSHOTCONTEXT</code> becomes <a class="xref" href="../api/Alphaleonis.Win32.Vss.VssSnapshotContext.html">VssSnapshotContext</a>, <code>VSSCTXFILESHARE_BACKUP</code> becomes <a class="xref" href="../api/Alphaleonis.Win32.Vss.VssSnapshotContext.html#Alphaleonis_Win32_Vss_VssSnapshotContext_FileShareBackup">FileShareBackup</a> and so on.</p>
</li>
<li><p>Errors are handled by exceptions and not return codes. AlphaVSS provides a full set of exception classes matching the various possible return codes from the native VSS API.</p>
</li>
<li><p>Many methods of the interfaces are changed to avoid out parameters and to use standard .NET constructs instead of the more clumsy C++ constructs. This should be clear from the API Reference documentation.</p>
</li>
</ul>
<h2 id="limitations">Limitations</h2>
<p>AlphaVSS currently does not provide any support for creating writers or providers.</p>
<h1 id="background">Background</h1>
<p>Using the <a class="xref" href="https://docs.microsoft.com/en-us/windows/win32/vss/volume-shadow-copy-service-portal">Windows Volume Shadow Copy Service (VSS)</a> on the .NET platform in C# (or VB) is somewhat problematic. There are numerous posts online about this issue, neither ever mentioning a robust solution that would allow full access to the VSS API from within a .NET application.  The reason seems to be that the main VSS interfaces are not true COM interfaces but rather simple C++ interfaces. This means that there is no type library available to import into your .NET application, and creating one from the existing DLL-files seems impossible.</p>
<p>The only viable solution to this problem appears to be to write a custom wrapper in managed C++/CLI, that provides a managed interface to the VSS API that can then be used from a .NET application. The sheer number of interfaces, structures and functions in the Volume Shadow Copy API are quite large, and writing a complete wrapper for all of this is not an attractive undertaking as part of your application development.</p>
<p>AlphaVSS was created as a solution to these complexities, and to be as simple to include in your application as any other .NET class library, but without simplifying the functionality to the point where you as a developer don’t have access to the functionality you need.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/alphaleonis/AlphaVSS/blob/heads/tags/2.0.0/docs/articles/intro.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
